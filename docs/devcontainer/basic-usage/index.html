
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Basic Container Usage</title>
  <link rel="icon" type="image/png" href="/assets/images/favicon.ico"/>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="basic-usage"
                  title="Basic Container Usage"
                  environment="web"
                  feedback-link="https://github.com/UCSB-PSTAT/computing/issues">
    
      <google-codelab-step label="Introduction" duration="0">
        <p>This tutorial will show how to connect to a remote server such as Alta using VS Code, setup the development container environment, and use what it has to offer!</p>
<p><strong>If you run into any issues during this tutorial, please ask for help in the </strong><a href="https://chat.google.com/room/AAAAR6wMcN0?cls=7" target="_blank"><strong>PSTAT Research Computing Users</strong></a><strong> Google Group!</strong></p>
<h2 is-upgraded>Prereqs</h2>
<ul>
<li><a href="https://code.visualstudio.com/" target="_blank">VS Code</a> text editor</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" target="_blank">Remote Development Pack</a> Extension</li>
<li>Install in VS Code by searching the extension shop using <code>ctrl</code>/âŒ˜ + <code>shift</code> + <code>x</code> shortcut.</li>
<li>PSTAT User Account</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Connecting to a server" duration="0">
        <p>To run your code remotely you will first need to connect to a remote server such as Alta. For more information about available computing servers, checkout <a href="https://computing.pstat.ucsb.edu/docs/computing#remote-computing-sources" target="_blank">this wiki entry</a>.  </p>
<p>With our VS Code extensions, remote connections are made simple:</p>
<ol type="1" start="1">
<li>Click on the <strong>bottom right button</strong> to &#34;Open a Remote Window&#34;.  This will launch the VS Code command palette for remote connections:</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/e7b78f90ed714322.png"></p>
<ol type="1" start="2">
<li>Select &#34;Connect Current Window to Host...&#34; option.</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/f4f8707f51fa6425.png"></p>
<ol type="1" start="3">
<li>From here select the host you wish to connect to.  If the remote host that you want to connect to does not appear in the options, use the &#34;Add New SSH Host...&#34; option.  Type the following command where you replace <code>&lt;NetID&gt;</code> with your own NetID:</li>
</ol>
<pre>ssh &lt;NetID&gt;@alta.pstat.ucsb.edu</pre>
<aside class="warning"><p><strong>Note:</strong> This will connect you to Alta. If using another PSTAT server, replace <code>alta.pstat.ucsb.edu</code> with <code>&lt;server-name&gt;.pstat.ucsb.edu</code> where your <code>&lt;server-name&gt;</code> name is replaced with a server such as wavelet, denali, roble, etc.</p>
</aside>
<p class="image-container"><img style="width: 624.00px" src="img/6735872e28d74eab.png"></p>
<ol type="1" start="4">
<li>You will be prompted to save the configuration.  Make sure to select either <code>C:\Users\&lt;your_username&gt;\.ssh\config</code> (Windows) or <code>~/.ssh/config</code> (MacOS/Linux).</li>
<li>From here, VS Code will automatically connect to the host for you.  If this is your first time connecting to any remote server, it may take a few seconds for VS Code to install configurations in the background.  <em>You may also be prompted about the type of operating system your server uses - select </em><strong><em>&#34;Linux&#34;</em></strong>.  Once the setup is complete you will be greeted with a similar window:</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/2280f6e069b54106.png"></p>
<aside class="special"><p>We are now connected to Alta! In the next steps we will generate your project directory with all the necessary files to develop in a container.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Setup Development Containers" duration="0">
        <p>Now that you are connected to a server, we can set up the development container!</p>
<ol type="1" start="1">
<li>In your terminal, run the following code where you should replace <code>&lt;project-name&gt;</code> with the name of your project/directory you wish to create:</li>
</ol>
<pre>copier copy gh:UCSB-PSTAT/devcontainer-template &lt;project-name&gt;</pre>
<aside class="warning"><p><strong>Note:</strong> Your project name should be <strong>unique</strong> i.e. if you have multiple projects you are working on, they should not share the same name. This can cause issues for the containers of each project.</p>
</aside>
<ol type="1" start="2">
<li>Answer the questions by selecting from the options provided.  An example can be seen below:</li>
</ol>
<pre>ðŸŽ¤ What is the name of your project? (Must be unique and use lowercase, dashes -, underscores _ ONLY)
   my-awesome-project
ðŸŽ¤ What language(s) will you use in this project?
   R
ðŸŽ¤ Do you want to install Visual Studio Code extensions for Jupyter notebooks using R?
   Yes
ðŸŽ¤ Install RStudio Server? This is optional if using VS Code and R extensions for development.
   Yes
ðŸŽ¤ Install Quarto? Quarto is optional publishing system compatible with R.
   Yes
ðŸŽ¤ Do you want to include example files?
   Yes

Copying from template version 1.1.0
    create  .
    create  .devcontainer
    create  .devcontainer/Dockerfile
    create  .devcontainer/devcontainer.json
    create  README.md
    create  example.Rmd
    create  .copier-answers.yml</pre>
<ol type="1" start="3">
<li>Run the command below to view your new project folder (again, replace <code>&lt;project-name&gt;</code> with the name of your project/directory you created):</li>
</ol>
<pre>tree -a &lt;project-name&gt;</pre>
<pre>&lt;project-name&gt;
â”œâ”€â”€ .copier-answers.yml
â”œâ”€â”€ .devcontainer
â”‚   â”œâ”€â”€ devcontainer.json
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ example.Rmd
â”œâ”€â”€ example-R.qmd
â””â”€â”€ README.md</pre>
<aside class="special"><p>You&#39;re project is ready to go!  In the next section we will show how to start up the container to run your code!</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Starting Your Container" duration="0">
        <ol type="1" start="1">
<li>You now have a new directory in which you can open up a development container!  To do so, click on &#34;Open Folder&#34; in the left menu and navigate to your project folder&#39;s name:</li>
</ol>
<p class="image-container"><img style="width: 488.50px" src="img/8f06e5cd30270ec9.png"></p>
<p class="image-container"><img style="width: 495.50px" src="img/2beba4c70637171a.png"></p>
<ol type="1" start="2">
<li>Click OK.  This will open up your project&#39;s folder (in the example, it will open &#34;my-research-project&#34;.</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/e27ebbeed625981c.png"></p>
<ol type="1" start="3">
<li>From here, you can click to &#34;Reopen in Container&#34; or click on the bottom left green button and select &#34;Reopen in Container&#34;:</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/b7e6d6e2ae249c4f.png"></p>
<ol type="1" start="4">
<li>Your container will be built.  You can click on the bottom right hand dialogue to view the build process log file.</li>
</ol>
<aside class="warning"><p><strong>Note:</strong> The first time build process can take <em>20-30 minutes</em> to complete! Please be patient! After the first build, starting up a container will take less than 10 seconds.</p>
</aside>
<p class="image-container"><img style="width: 624.00px" src="img/506b73bb6a32b876.png"></p>
<ol type="1" start="5">
<li>To leave the container you can click on the bottom left green button and click on the option &#34;Reopen folder in SSH&#34;.</li>
</ol>
<aside class="special"><p>Your container is now ready to use on Alta! Note that the bottom left hand corner now says that you are working in a Dev Container. Feel free to jump in and begin working. Additional information on available tools and package installation can be found in the next steps.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Accessing Jupyterhub &#43; RStudio" duration="0">
        <p>Although you can edit files directly in VS Code, it may be more preferable to utilize more specialized tools such as RStudio to edit files such as Qmd/Rmd. This requires us to access Jupyterhub.</p>
<ol type="1" start="1">
<li>Open up a new terminal window either by pressing the &#34;+&#34; in the tool pane or by using ctrl/cmd + ` on your keyboard:</li>
</ol>
<p class="image-container"><img style="width: 438.50px" src="img/c436e22794791999.png"></p>
<ol type="1" start="2">
<li>You will see the following terminal pop-up.  Inside of it, there will be a &#34;Jupyter server token&#34;.  Copy it for the following step.</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/628ef7b56df020ad.png"></p>
<ol type="1" start="3">
<li>Head into &#34;Ports&#34;.  Look for port 8888 (which will be labeled as &#34;Jupyterlab&#34;).  Mouse over the &#34;Forwarded Address&#34; box and click on &#34;Open in Browser&#34;:</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/f01f6e0dab5738ab.png"></p>
<ol type="1" start="4">
<li>You will be taken to the following login page.  Here you can input your copied Jupyter token or scroll down and set a password.  Either way, every time you open the terminal you will always have access to the Jupyter token.</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/4370c659d6a83292.png"></p>
<ol type="1" start="5">
<li>Upon logging in you will have access to Jupyterlab! From here, you can edit your files/notebooks using its interface or RStudio.</li>
</ol>
<p class="image-container"><img style="width: 624.00px" src="img/6b2815ef4478c5f9.png"></p>
<ol type="1" start="6">
<li>To open RStudio, simply select the RStudio button in the launcher.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Installing Packages" duration="0">
        <aside class="warning"><p><strong>Note on reproducibility:</strong> If you have questions about or wish to get help with including your R/Python language packages as part of your container configuration files (Dockerfile and devcontainer.json, please contact the Computing TA via the <a href="https://chat.google.com/room/AAAAR6wMcN0?cls=7" target="_blank"><strong>PSTAT Research Computing Users</strong></a> group.</p>
</aside>
<h2 is-upgraded>Python</h2>
<h3 is-upgraded>Inside Container (immediate)</h3>
<p><em>This method will install packages immediately in your container but will </em></p>
<p><strong><em>not</em></strong></p>
<p><em> get added to your container configuration files for reproducibility by others. </em></p>
<p>To install packages using the Anaconda distribution use the <code>mamba</code> command. This follows the same syntax as <code>conda</code> but runs a lot faster.  To install packages using PyPI, it is sufficient to use <code>pip</code>. </p>
<pre>$&gt; mamba install numpy=1.26
...
$&gt; pip install scikit-ntk==1.1.3</pre>
<h3 is-upgraded>Inside Dockerfile (reproducible)</h3>
<p><em>This method will build your container with these packages pre-installed. If you share your configuration files with someone else, they will be able to reproduce your installation with no additional steps. </em></p>
<p><strong><em>You will need to rebuild your container to install packages this way!</em></strong></p>
<p>To install Python packages in a reproducible way, you will need to add them to your Dockerfile.  Simply add the package name underneath the comment for Anaconda/Pip packages followed by a â€˜\&#39;.  </p>
<p>For example, here I am adding a Anaconda distribution package <code>scikit-learn</code> (using conda/mamba commands): </p>
<p class="image-container"><img style="width: 624.00px" src="img/e1545980236a4ed2.png"></p>
<p>And here, I am adding a PyPI package <code>scikit-ntk</code> (using pip command):</p>
<p class="image-container"><img style="width: 624.00px" src="img/18d4398c83dc216a.png"></p>
<h2 is-upgraded>R</h2>
<h3 is-upgraded>Inside Container (immediate)</h3>
<p><em>This method will install packages immediately in your container but will </em></p>
<p><strong><em>not</em></strong></p>
<p><em> get added to your container configuration files for reproducibility by others. </em></p>
<p>For R, any of your favorite commands for package installation should function out of the box (<code>install.packages(...)</code> being the most common). This can be run in 3 ways:</p>
<ul>
<li>Inside VS Code terminal <em>without</em> launching R:</li>
</ul>
<pre>$&gt; R -e â€˜install.packages(&#34;ggplot2&#34;)&#39;</pre>
<ul>
<li>Inside an attached R terminal either by typing &#34;R&#34; in VS Code terminal or attaching via interface:</li>
</ul>
<p class="image-container"><img style="width: 624.00px" src="img/504744791081f379.png"></p>
<ul>
<li>Inside RStudio server</li>
</ul>
<h3 is-upgraded>Inside Dockerfile (reproducible)</h3>
<p><em>This method will build your container with these packages pre-installed. If you share your configuration files with someone else, they will be able to reproduce your installation with no additional steps. </em></p>
<p><strong><em>You will need to rebuild your container to install packages this way!</em></strong></p>
<p>To install R packages in a reproducible way, you will need to add them to your Dockerfile.  You will need to add packages using this type of command underneath the comment for R packages followed by a â€˜&amp;&amp; \&#39;:</p>
<pre>R -e â€˜install.packages(&#34;ggplot2&#34;)&#39; &amp;&amp; \</pre>
<p>For example, here I am adding the <code>dplyr</code> package:</p>
<p class="image-container"><img style="width: 624.00px" src="img/5031887ad8f83311.png"></p>
<h2 is-upgraded>System Packages</h2>
<p>If your language specific packages have additional system related requirements, the easiest way to install them is to directly add them to the Dockerfile found in the .devcontainer directory of your project as shown below:</p>
<p class="image-container"><img style="width: 624.00px" src="img/a8141b3e9ccef61b.png"></p>
<p>Here I am installing an additional package called &#34;neofetch&#34;. <strong>Make sure that each package is on its own separate line and ends with a backslash!</strong></p>
<aside class="warning"><p><strong>Note:</strong> Modifying container files will require you to rebuild the container! This can be done by using the keyboard shortcut ctrl/cmd + shift + p and typing &#34;Rebuild Container&#34;:</p>
<p class="image-container"><img style="width: 610.00px" src="img/dc50776a6642114e.png"></p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Using GitHub" duration="0">
        <p>If you wish to clone/push/pull/create repositories, you will need to use <a href="https://cli.github.com/manual/" target="_blank">GitHub CLI</a> to login while inside the container. This can be done using the <code>gh auth login</code> command. During the steps select:</p>
<ul>
<li>GitHub.com for your account</li>
<li>HTTPS for your preferred protocol</li>
<li>Yes to authenticating with your GitHub credentials</li>
<li>Lastly, login with your web browser to complete authentication</li>
</ul>
<p class="image-container"><img style="width: 624.00px" src="img/4f89456412ff79a2.png"></p>
<p>Once completed, you will now be able to manage GitHub repositories using HTTPS.</p>
<p>If you wish to create a repository on your GitHub account for your freshly minted project container use the following commands:</p>
<ol type="1" start="1">
<li>Convert generated files to a repository:</li>
</ol>
<pre>cd /home/jovyan/work/
git init
git add *
git commit -m &#34;first commit&#34;
git branch -M main</pre>
<ol type="1" start="2">
<li>Upload local repository to a new GitHub repository. <strong>Be sure to choose, &#34;Push an existing local repository to GitHub&#34;</strong>:</li>
</ol>
<pre>cd /home/jovyan/my-awesome-project
gh repo create</pre>


      </google-codelab-step>
    
      <google-codelab-step label="Next Steps" duration="0">
        <aside class="special"><p>Congrats! You are now ready to work on your project within the Alta server on your own personal development container!  </p>
<p><em>Make sure you&#39;re a part of the </em><a href="https://chat.google.com/room/AAAAR6wMcN0?cls=7" target="_blank"><strong><em>PSTAT Research Computing Users</em></strong></a><em> Google Spaces group to stay up-to-date with the latest beta testing information!</em></p>
</aside>
<p>To get more familiar with how your container works consider the following sets of tutorials:</p>
<ul>
<li><a href="https://computing.pstat.ucsb.edu/docs/devcontainer#management" target="_blank">Learn to manage your containers</a></li>
<li><a href="https://computing.pstat.ucsb.edu/docs/devcontainer#additional-features" target="_blank">Learn more about custom setups</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script>
    // This is to override the close / done handling on the page
    // https://github.com/googlecodelabs/tools/issues/103
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById("arrow-back").href="/docs/devcontainer#setup"; 
      document.getElementById("arrow-back").addEventListener( 'click', function() { 
        window.history.back();
      }); 
      document.getElementById("done").href="/docs/devcontainer#setup"; 
      document.getElementById("done").addEventListener( 'click', function() { 
        window.history.back();
      }); 
    }, false);
  </script>
</body>
</html>
